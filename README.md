# 행성계 만들기

## 작품 기획
---
이전 three.js의 기초를 강의 영상을 통해서 배울 때 최종적으로 만들어 지는 것이 중앙의 구와 그 주위를 둘러싸는 토러스를 통과하며 원 형태로 돌아다니는 작은 구의 모습이었는데,

여기에서 떠올린 간단한 응용 예시이다.

마침 자료도 많은 응용 형태였기에 여러 곳에서의 도움을 받아 행성계를 만들어 보기로 했다.


## 완성된 모습
---

![rdplanet](https://github.com/CommercialCrew/RandomPlanet/assets/101386134/48adb6ef-9206-4b0f-9614-890edb01e701)

## 코드의 각 부분에 대한 설명
---

크게 행성 자체의 구현과 카메라 배치, 빛 등 가장 메인이 되는 요소를 포함한 "App.jsx"와
행성의 텍스처, 크기, 자전주기, 공전주기, 실행 시의 위치 등을 랜덤으로 지정하고, 행성들의 수를 결정하는 등 행성계의 여러 요소들을 저장하는 역할을 하는 "planetData.jsx"로 나누어진다.




---

### App.jsx
---

function App(): 다른 언어에서의 main()의 역할을 하는 부분으로, 카메라와 항성, 행성, 빛을 배치했고, OrbitControls를 적용해 마우스 드래그로 이리저리 살펴볼 수 있게 했다.

항성과 행성은 별개의 function으로 분리해두고 <Sun />과 같이 적어둠으로 구현했고, 

그 중 갯수가 여러개인 행성들은 배열은 따로 만들어두고 지정한 갯수만큼 배열을 순회하며 정보를 집어넣는 방식으로
 <Planet planet={planet} key={planet.id} /> 와 같이구현했다.
이 부분은 planetData.jsx의 설명에서 조금 더 자세하게 다룬다.

Suspense 부분에 대해서는 'useLoader' 에 대해 조금 알 필요가 있다.

useLoader는 R3F에서 리소스를 로드해올 때 사용되는데, 이걸 사용하면 사이트를 로드하는 과정에서 '비동기 로드 상태'가 된다.

이 상태를 처리하지 않고 그대로 둘 경우 로딩 과정에서 오류가 발생해 Sun 부분이나 Planet 부분에서 표시해야 할 항성, 행성들이 로드되지 않고 끝난다.

이 부분을 오류 없이 처리하기 위해 사용해야 하는 것이 바로 Suspense로,
<Suspense fallback={null}> 부분은 다른 특별한 처리 없이 로드가 끝날 때 까지 빈 화면으로 대기하게 하는 부분이다.

이 부분을 적절히 수정해 로딩 페이지를 만들수도 있다.


이후 Lights 부분은 행성계의 광원 처리 부분이다.

---

function Sun(): 행성들은 텍스처를 랜덤 배정해야 하기 때문에 다른 파일로 텍스처를 빼놓고 적용했지만, 항성은 이 파일에 직접 텍스처 파일을 추가했다.

import sunTexture from "./textures/sun.jpg"; 부분이 해당 부분이고, 이를 useLoader를 이용해 불러온다.


---

function Planet(): 매개변수 부분 안에 planet: {} 으로 필요한 요소들을 추가해두었다.

둘레나 크기, 속도, 시작지점, 적용되는 텍스처 등이 포함되어 있다.

텍스처는 항성과 같은 방식으로 로드하고, useFrame을 이용하여 행성의 이동을 실시간으로 처리한다.


---

function Lights(): 광원을 처리하는 부분이다.


---

function Ecliptic(): 직역하면 '황도'가 되는데, 행성이 항성을 중심으로 도는 궤도를 따라 선으로 궤적을 그려주는 역할을 한다.

시작 지점과 항성의 위치, 그리고 현재 지점에 따른 각도를 이용해 값을 따와 궤도를 선으로 그린다.




---
### planetData.jsx
---

행성의 다양한 요소를 결정하는 파일이다.

가장 앞의 import 문을 통해 행성의 텍스처를 불러왔는데, 행성은 6개를 만들 예정이었으므로 6개를 로드했다.

---
const shuffle: 배열의 요소를 랜덤으로 섞어주는 역할을 한다. 쓰이는 곳은 텍스처를 섞는 부분 뿐이다.


---
const textures: 이 부분에 import 해온 텍스처들을 집어넣고 행성에 랜덤 배정한다. 페이지를 새로 열거나 새로고침을 할 때 마다 바뀐다.

---
const random, randomInt, randomColor: 앞의 둘은 랜덤한 값을 만들어내기 위해 만들었고, randomColor는 행성의 색을 랜덤으로 배정하지만 텍스처를 사용하기로 했기 때문에 사용되지 않는다.

---
const planetData: 행성의 정보를 저장하기 위한 것으로, 
id는 행성들을 서로 구분짓기 위함, 
xRadius와 zRadius는 행성의 궤도를 결정지을 때 사용되는 가로와 세로 반지름,
size는 행성의 크기, 
speed는 행성의 공전속도, 
offset은 로드 시 시작지점, 
rotationSpeed는 자전속도이며 
textureMap은 적용할 텍스처를 결정한다.




## 프로젝트 완료 후의 소감
---

사실상 혼자서 진행하는 프로젝트였기에 제 개인의 역량 내에서 충분히 해낼 수 있으면서, 수업 중에 배웠던 내용을 착실히 적용해낸 결과물을 만들어 내려고 노력했습니다.

지금까지 배워온 요소 모든 요소를 하나하나 전부 반영하지는 못했지만, 만드는 과정에서 '이건 이렇다고 배웠었지' 라고 생각하면서 배웠던 내용들을 다시보게 해줬던 좋은 과제였습니다.

비록 다른 팀에 비해서는 많이 부족한 결과물을 냈지만, 이번 학기에 배워운 three.js의 요소들을 총정리 한다는 프로젝트의 본목적은 달성해냈다고 생각합니다.

지난 두세달간의 가르침 정말 감사드리고 남은 한달간의 배움도 기대치 최대로 기다리고 있겠습니다!
